(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class m{constructor(e){this._editedTaskId=e,this._dialogElement=document.querySelector("#task-edit-dialog"),this._formElement=this._dialogElement.querySelector("#task-edit-form"),this._closeFormBtn=this._dialogElement.querySelector(".cancel-btn"),this.configure()}showForm(){this._dialogElement.showModal()}closeForm(){var e;this.clearForm(),(e=this._dialogElement)==null||e.close()}configure(){this._closeFormBtn.addEventListener("click",this.closeForm.bind(this)),this._formElement.addEventListener("submit",this.submitFormHandler.bind(this))}submitFormHandler(e){e.preventDefault();const t=this._formElement.querySelector("#edit-title").value,i=this._formElement.querySelector("#edit-due-date").value,s=this._formElement.querySelector("#edit-priority").value,r=this._formElement.querySelector("#edit-description").value,o=n.getInstance().findTaskById(this._editedTaskId);(s==="high"||s==="medium"||s==="low")&&(o&&(o.title=t,o.dueDate=new Date(i),o.priority=s,o.description=r),this.closeForm(),n.getInstance().renderTasksByType())}clearForm(){this._formElement.querySelector("#edit-title").value="",this._formElement.querySelector("#edit-due-date").value="",this._formElement.querySelector("#edit-priority").value="",this._formElement.querySelector("#edit-description").value=""}setFormFieldsFromTask(e){this._formElement.querySelector("#edit-title").value=e.title,this._formElement.querySelector("#edit-due-date").value=e.dueDate.toISOString().split("T")[0],this._formElement.querySelector("#edit-priority").value=e.priority,e.description&&(this._formElement.querySelector("#edit-description").value=e.description)}}class u{constructor(e,t,i){var s,r,o,l,d,c;this._projectState=n.getInstance(),this._sourceElement=e,this._targetElement=t,this._currentElement=(r=(s=this._sourceElement)==null?void 0:s.content.firstElementChild)==null?void 0:r.cloneNode(!0),this._task=i,this._status=(o=this._currentElement)==null?void 0:o.querySelector(".task-status"),this._detailsIcon=(l=this._currentElement)==null?void 0:l.querySelector(".task-details"),this._editIcon=(d=this._currentElement)==null?void 0:d.querySelector(".task-edit"),this._deleteIcon=(c=this._currentElement)==null?void 0:c.querySelector(".task-delete"),this.configure()}renderContent(){const e=this._currentElement.querySelector(".task-title");e.innerText=this._task.title;const t=this._currentElement.querySelector(".task-due-date");t.innerText=this._task.dueDate.toDateString();const i=this._currentElement.querySelector(".task-priority");i.innerText=this._task.priority;const s=this._currentElement.querySelector(".task-status-label");this._task._isCompleted?(this._status.checked=!0,s.innerText="Completed"):(this._status.checked=!1,s.innerText="Not completed"),this._targetElement.append(this._currentElement)}configure(){this._status.addEventListener("click",this.updateStatus.bind(this)),this._detailsIcon.addEventListener("click",this.showTaskDetails.bind(this)),this._editIcon.addEventListener("click",this.editTask.bind(this)),this._deleteIcon.addEventListener("click",this.deleteTask.bind(this))}updateStatus(){const e=this._currentElement.querySelector(".task-status-label");this._status.checked?(this._task._isCompleted=!0,e.innerText="Completed"):(this._task._isCompleted=!1,e.innerText="Not completed"),n.getInstance().saveToLocalStorage()}showTaskDetails(){const e=document.querySelector(".task-detals-dialog"),t=this._task.title,i=this._task.dueDate.toDateString(),s=this._task.description,r=this._task.priority;e.querySelector(".task-details-title").innerText=t,e.querySelector(".task-details-due-date").innerHTML="<b>Task due date:</b> "+i,s?e.querySelector(".task-details-description").value=s:e.querySelector(".task-details-description").value="No description provided",e.querySelector(".task-details-priority").innerHTML="<b>Task priority:</b> "+r,e.showModal()}editTask(){const e=this._projectState.findTaskByName(this._task.title);if(e){const t=new m(e.id);t.setFormFieldsFromTask(e),t.showForm()}else return;n.getInstance().saveToLocalStorage()}deleteTask(){this._projectState.removeTask(this._task.title)}}class h{constructor(e,t,i,s,r=Math.random()%1e3,o=!1){this._title=e,this._dueDate=t,this._priority=i,this._description=s,this._id=r,this._isCompleted=o}get id(){return this._id}get title(){return this._title}set title(e){this._title=e}get description(){return this._description}set description(e){if(e)this._description=e;else return}get dueDate(){return this._dueDate}set dueDate(e){this._dueDate=e}get priority(){return this._priority}set priority(e){this._priority=e}get isCompleted(){return this._isCompleted}set isCompleted(e){this._isCompleted=e}}class n{constructor(){this._tasks=[],this._renderType=0,this.getFromLocalStorage()}static getInstance(){return n._instance||(n._instance=new n),n._instance}saveToLocalStorage(){localStorage.setItem("tasks",JSON.stringify(this._tasks))}getFromLocalStorage(){const e=localStorage.getItem("tasks");if(e)try{const t=JSON.parse(e);this._tasks=t.map(i=>new h(i._title,new Date(i._dueDate),i._priority,i._description,i._id,i._isCompleted))}catch{console.error("Failed to load tasks from local storage"),this._tasks=[]}}addTask(e){this._tasks.push(e),this.renderTasksByType(this._renderType),this.saveToLocalStorage()}findTaskByName(e){return this._tasks.find(t=>t.title===e)}findTaskById(e){return this._tasks.find(t=>t.id===e)}removeTask(e){const t=this._tasks.findIndex(i=>e===i.title);t!==-1&&this._tasks.splice(t,1),localStorage.setItem("tasks",JSON.stringify(this._tasks)),this.renderTasksByType(this._renderType),this.saveToLocalStorage()}renderTasksByType(e){switch((e||e===0)&&(this._renderType=e),this._renderType){case 0:this.renderAll();break;case 2:this.renderCompleted();break;case 1:this.renderToday();break;case 3:this.renderMissed();break;default:return}}renderTasks(e){this.renderTasksTitle();const t=document.querySelector("#task-template"),i=document.querySelector("#tasks");if(e){i.innerText="";for(const s of e)new u(t,i,s).renderContent()}else{i.innerText="";for(const s of this._tasks)new u(t,i,s).renderContent()}}renderAll(){this.renderTasks(this._tasks.filter(e=>!e._isCompleted&&!this.isTaskOutdated(e))),this._renderType=0}renderToday(){const e=new Date,t=this._tasks.filter(i=>i.dueDate.getFullYear()===e.getFullYear()&&i.dueDate.getMonth()===e.getMonth()&&i.dueDate.getDay()===e.getDay()&&!i._isCompleted&&!this.isTaskOutdated(i));this.renderTasks(t),this._renderType=1}renderCompleted(){const e=this._tasks.filter(t=>t._isCompleted&&!this.isTaskOutdated(t));this.renderTasks(e),this._renderType=2}renderMissed(){const e=this._tasks.filter(t=>this.isTaskOutdated(t));this.renderTasks(e),this._renderType=3}isTaskOutdated(e){const t=new Date;return(e.dueDate.getFullYear()<t.getFullYear()||e.dueDate.getFullYear()===t.getFullYear()&&e.dueDate.getMonth()<t.getMonth()||e.dueDate.getFullYear()===t.getFullYear()&&e.dueDate.getMonth()===t.getMonth()&&e.dueDate.getDate()<t.getDate())&&!e._isCompleted}renderTasksTitle(){const e=document.querySelector("#tasks-container-title");switch(this._renderType){case 0:e.innerText="All tasks";break;case 1:e.innerText="Today tasks";break;case 2:e.innerText="Completed tasks";break;case 3:e.innerText="Missed tasks";break;default:e.innerText="All tasks"}}}class _{constructor(){this._projectState=n.getInstance(),this._allTasks=document.querySelector("#all-tasks"),this._todayTasks=document.querySelector("#today-tasks"),this._completedTasks=document.querySelector("#completed-tasks"),this._missedTasks=document.querySelector("#missed-tasks"),this.configure()}configure(){this._allTasks.addEventListener("click",this.displayAllTasks.bind(this)),this._todayTasks.addEventListener("click",this.displayTodayTasks.bind(this)),this._completedTasks.addEventListener("click",this.displayCompletedTasks.bind(this)),this._missedTasks.addEventListener("click",this.displayMissedTasks.bind(this))}displayAllTasks(){this._projectState.renderTasksByType(0)}displayTodayTasks(){this._projectState.renderTasksByType(1)}displayCompletedTasks(){this._projectState.renderTasksByType(2)}displayMissedTasks(){this._projectState.renderTasksByType(3)}}class p{constructor(){this._dialogElement=document.querySelector("#task-input-dialog"),this._formElement=this._dialogElement.querySelector("#task-input-form"),this._openFormBtn=document.querySelector("#new-task-btn"),this._closeFormBtn=this._dialogElement.querySelector(".cancel-btn"),this.configure()}showForm(){this.clearForm(),this._dialogElement.showModal()}closeForm(){var e;this.clearForm(),(e=this._dialogElement)==null||e.close()}configure(){this._openFormBtn.addEventListener("click",this.showForm.bind(this)),this._closeFormBtn.addEventListener("click",this.closeForm.bind(this)),this._formElement.addEventListener("submit",this.submitFormHandler.bind(this))}submitFormHandler(e){e.preventDefault();const t=this._formElement.querySelector("#input-title").value,i=this._formElement.querySelector("#input-due-date").value,s=this._formElement.querySelector("#input-priority").value,r=this._formElement.querySelector("#input-description").value;if(s==="high"||s==="medium"||s==="low"){const o=new h(t,new Date(i),s,r);n.getInstance().addTask(o),this.closeForm()}}clearForm(){this._formElement.querySelector("#input-title").value="",this._formElement.querySelector("#input-due-date").value="",this._formElement.querySelector("#input-priority").value="",this._formElement.querySelector("#input-description").value=""}}new p;new _;const k=n.getInstance();k.renderTasksByType(0);
